<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"
        integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog=="
        crossorigin="anonymous" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/jquery.terminal/js/jquery.terminal.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/jquery.terminal/css/jquery.terminal.min.css" />
</head>


<body>
    <div class="center">
        <div class="menu">
            <li class="item" id="profile">
                <a href="#profile" class="btn"><i class="far fa-user" aria-hidden="true"></i>Profile</a>
                <div class="smenu">
                    <a href="#posts">Posts</a>
                    <a href="#about">About Me</a>
                </div>
                <div class="page" id="about">
                    <div class='content'>
                        <p>Haoxuan Ma (or Rex)</p>
                        <br>
                        <p>
                            I've always been convinced that I would end up doing
                            creative works for my life.
                            I try to bring together all kinds of subjects that I'm interested in
                            and create things that excite me, and bring people joy.
                        </p>
                        <br><br>
                    </div>
                </div>
                <div class="page" id="posts">
                    <div class='content'>
                        <p>Under Construction...</p>
                        <br><br>
                    </div>
                </div>
            </li>
            <li class="item" id="works">
                <a href="#works" class="btn"><i class="fas fa-cog" aria-hidden="true"></i>Works</a>
                <div class="smenu">
                    <a href="#game">Game</a>
                    <a href="#photo">Photo</a>
                    <a href="#music">Music</a>
                </div>
                <div class="page" id="game">
                    <div id="terminal"></div>
                </div>
                <div class="page" id="photo"></div>
                <div class="page" id="music"></div>

            </li>
            <li class="item" id="contact">
                <a href="#contact" class="btn"><i class="fas fa-paper-plane" aria-hidden="true"></i>Contact</a>
                <div class="smenu">
                    <a href="">Email</a>
                </div>
            </li>
            <li class="item" id="logout">
                <a href="" class="btn"><i class="fas fa-sign-out-alt"></i>Logout</a>
            </li>
        </div>
    </div>

</body>
<script>
    // terminal in works
    $(window).on('load', () => {
        $('.item .btn').click(reset)
        $(".smenu a").click((e) => {
            $(".page").animate({ // layer 1
                "max-height": "0em",
            }, () => { // layer 2
                $(".smenu").css({
                    "max-height": "", // reset, so hover can still work
                })
                id = $(e.target).parent().parent().attr('id')
                id2 = $(e.target).attr('href')
                called = false
                $(".menu").animate({ // layer 3
                    "width": "50em"
                }, () => { // layer 4
                    $('#' + id + " .smenu").css({
                        "max-height": "0em",
                    })
                    $('#' + id + ' ' + id2).css({
                        "max-height": "40em",
                    })

                    if (id2 == "#game" && !called) {
                        called = true // prevent multiple calls to terminal object
                        terminal();
                    }
                })
            })
        })
    })

    function reset() {
        // send email and process string data to do something musical or visual
        console.log('here')
        $(".page").animate({ // layer 1
            "max-height": "0em",
        }, () => { // layer 2
            $(".menu").animate({
                "width": "300px"
            }, () => { // layer 3
                $(".smenu").css({
                    "max-height": "", // reset, so hover can still work
                })
            })
        })
    }

    function terminal() {
        let file_list = ['file01', 'file02', 'file03']
        let file_locks = [true, true, false]
        $('#terminal').terminal({
            cub: function (flag) {
                switch (flag) {
                    case '--help':
                        this.echo(`usage: cub
                                    [--help] shows all the help messages
                                    [--games] lists all avaliable games I made
                                    [--ar] lists some ar mini projects I made,
                                           they perform better using your phone
                                    [--play] plays a mini puzzle game
                        `)
                        break
                    case '--games':
                        list_games(this)
                        break
                    case '--ar':
                        list_ar(this)
                        break
                    case '--play':
                        this.echo('under construction...')
                        break
                }
            },
            ls: function () {
                for (let i = 0; i < file_list.length; i++) {
                    let lock = '[unlocked]'
                    if (file_locks[i])
                        lock = '[locked]'
                    this.echo(file_list[i] + ' ' + lock)
                }
            },
            open: function (name) {
                let idx = file_list.indexOf(name)
                if (idx == -1) {
                    this.echo('failed: no such file!')
                }
                else {
                    if (file_locks[idx]) {
                        this.echo('failed: user not authenticated!')
                    }
                    else {
                        this.echo('opened file: ' + file_list[idx])
                    }
                }
            },
            cheat: function (code) {
                if (code == 'give_me_code') {
                    this.echo('Alright! The password is: password')
                }
            },
        }, {
            greetings: "Welcome! Type cub --help for more information.",
            height: 400,
            prompt: 'visitior>'
        })
    }

    function list_games(t) {
        t.echo('\t- A Maze In\n')
        t.echo('<a href="http://www-personal.umich.edu/~crescely/A%20Maze%20In_Web/" target="_blank">\
                    <img src = "./resource/a-maze-in.png" >\
                </a >', { raw: true });
        t.echo('\t- Ragnarok TD\n')
        t.echo('<a href="https://wolverinesoft-studio.itch.io/ragnarok-td" target="_blank">\
                    <img src = "./resource/ragnarok-td.png" >\
                </a >', { raw: true });
    }

    function list_ar(t) {
        t.echo('\t- AR Noter\n')
        t.echo('<a href="./noter/noter.html" target="_blank">\
                    <img src = "./resource/noter.png" >\
                </a >', { raw: true });
        t.echo('\t- AR Building Blocks\n')
        t.echo('<a href="./objectplane/index.html" target="_blank">\
                    <img src = "./resource/building.png" >\
                </a >', { raw: true });

        t.echo('IMPORTANT: go to cublegend.github.io/marker.png for the marker!')
    }
</script>

</html>