<head>
    <title>Uncle Mai</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <script src="https://aframe.io/releases/1.1.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="./css/mainStyle.css">
    <link rel="stylesheet" href="./css/style.css">
    <script>
    const current_audios = [];
    $(window).ready(function() {
        
        if(!window.location.hash) {
            window.location = window.location + '#loaded';
            window.location.reload();
        }
        let allthings = document.querySelectorAll("a-nft");
        allthings.forEach(element => {
            element.addEventListener("markerFound", function(event) {
                let str = event.currentTarget.querySelector("[gltf-model]").getAttribute("gltf-model");
                let num = str.slice(92, 96);
                let audio = new Audio("./resources/Geyao/" + num + ".mp3")
                current_audios.push(audio);
            })
            element.addEventListener("markerLost", function(event) {
                let str = event.currentTarget.querySelector("[gltf-model]").getAttribute("gltf-model");
                let num = str.slice(92, 96);
                let audio = new Auido("./resources/Geyao/" + num + ".mp3");
                current_audios.pop(audio);
            })
        });
        
    })

    function play_geyao() {
        current_audios.forEach(a => {
            a.play(); 
        })
    }
    </script>
</head>
<body>
   
    <div class="main-page">
        <img class="button" id="return" onclick="return_to_main()" src="./resources/UIpic/UI-223png.png">
        <img id="tl" src="./resources/UIpic/UI-32.png">
        <img id="tr" src="./resources/UIpic/UI-32.png">
        <img id="br" src="./resources/UIpic/UI-32.png">
        <img id="bl" src="./resources/UIpic/UI-32.png">
        <img class="button" id="geyao" onclick="play_geyao()" src="./resources/UIpic/UI-23.png">
        <a-scene renderer="logarithmicDepthBuffer: true;" embedded arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false;" vr-mode-ui="enabled: false">
            <a-nft
                type="nft"
                url="https://cublegend.github.io/UncleMai/resources/card-nft/steamship"
                smooth="true"
                smoothCount="10"
                smoothTolerance=".01"
                smoothThreshold="5"
            >
                <a-entity 
                    gltf-model="https://arjs-cors-proxy.herokuapp.com/https://cublegend.github.io/UncleMai/resources/models/jt05.gltf"
                    scale="400 400 400" 
                    position="50 0 -200"
                ></a-entity>
            </a-nft>
            <a-nft
                type="nft"
                url="https://cublegend.github.io/UncleMai/resources/card-nft/apple"
                smooth="true"
                smoothCount="10"
                smoothTolerance=".01"
                smoothThreshold="5"
            >
                <a-entity 
                    gltf-model="https://arjs-cors-proxy.herokuapp.com/https://cublegend.github.io/UncleMai/resources/models/sg14.gltf"
                    scale="400 400 400" 
                    position="50 0 -200"
                ></a-entity>
            </a-nft>
            <a-nft
                type="nft"
                url="https://cublegend.github.io/UncleMai/resources/card-nft/balloon"
                smooth="true"
                smoothCount="10"
                smoothTolerance=".01"
                smoothThreshold="5"
            >
                <a-entity 
                    gltf-model="https://arjs-cors-proxy.herokuapp.com/https://cublegend.github.io/UncleMai/resources/models/jt09.gltf"
                    scale="400 400 400" 
                    position="50 0 -200"
                ></a-entity>
            </a-nft>
            <a-entity camera></a-entity>
        </a-scene>
    </div>
    <div class="info">
        <p style="position: absolute; top: 50%; left: 50%;font-size: large;">请旋转手机</p>
    </div>
</body>
<script>
    function return_to_main () {
        window.location = "./index.html";
    }

    
    
</script>